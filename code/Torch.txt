#
# Creating torch light from an RGB led
#
# Uses only red and green, and noted that the green part is much stronger
# than the red. Using PWM pins for controlling the individual colors
#
# So a green value of red / 8 gives a good yellow tone
#

@@ Util.txt


3 CONSTANT rPin
5 CONSTANT gPin
6 CONSTANT bPin

: pOut NATIVE Pin.ModeOut ;

: init rPin pOut gPin pOut bPin pOut ;

: w NATIVE Pin.WriteAnalog ;

: rgb bPin w gPin w rPin w ;

(--- examples ---)
: yellow 80 10 0 rgb ;
: bright-orange 80 5 0 rgb ;
: dark-orange 80 3 0 rgb ;


: z NATIVE Sys.Delay ;

: off 0 0 0 rgb ;

: flicker
  30 random 50 + => red
  5 random 7 + => fact  (bigger factor gives redder light)
  red fact / => grn

  (
  "red:_ .str red print# "_green:_ .str grn print# cr
  )
  
  red grn 0 rgb
  80 random 20 + z
;


: main
  init
  BEGIN
  	flicker
  key not AGAIN?
  off
  "Done .str cr
;

